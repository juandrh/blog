<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Proceso de aprendizaje automático supervisado | Juan del Río</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Proceso de aprendizaje automático supervisado" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Una introducción la automatización del aprendizaje supervisado. Python + Pytorch" />
<meta property="og:description" content="Una introducción la automatización del aprendizaje supervisado. Python + Pytorch" />
<link rel="canonical" href="https://juandrh.github.io/blog/curso_fast.ai/ml/2021/07/28/Aprendizaje-automatico.html" />
<meta property="og:url" content="https://juandrh.github.io/blog/curso_fast.ai/ml/2021/07/28/Aprendizaje-automatico.html" />
<meta property="og:site_name" content="Juan del Río" />
<meta property="og:image" content="https://juandrh.github.io/blog/images/logo.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-07-28T00:00:00-05:00" />
<script type="application/ld+json">
{"url":"https://juandrh.github.io/blog/curso_fast.ai/ml/2021/07/28/Aprendizaje-automatico.html","@type":"BlogPosting","headline":"Proceso de aprendizaje automático supervisado","dateModified":"2021-07-28T00:00:00-05:00","datePublished":"2021-07-28T00:00:00-05:00","image":"https://juandrh.github.io/blog/images/logo.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://juandrh.github.io/blog/curso_fast.ai/ml/2021/07/28/Aprendizaje-automatico.html"},"description":"Una introducción la automatización del aprendizaje supervisado. Python + Pytorch","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://juandrh.github.io/blog/feed.xml" title="Juan del Río" /><link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">Juan del Río</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About Me</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Proceso de aprendizaje automático supervisado</h1><p class="page-description">Una introducción la automatización del aprendizaje supervisado. Python + Pytorch</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-07-28T00:00:00-05:00" itemprop="datePublished">
        Jul 28, 2021
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      3 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#curso_Fast.ai">curso_Fast.ai</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#ML">ML</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/juandrh/blog/tree/master/_notebooks/2021-07-28-Aprendizaje-automatico.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/juandrh/blog/master?filepath=_notebooks%2F2021-07-28-Aprendizaje-automatico.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/juandrh/blog/blob/master/_notebooks/2021-07-28-Aprendizaje-automatico.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-07-28-Aprendizaje-automatico.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Proceso-de-aprendizaje-autom&#225;tico-supervisado">Proceso de aprendizaje autom&#225;tico supervisado<a class="anchor-link" href="#Proceso-de-aprendizaje-autom&#225;tico-supervisado"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Partimos de una <strong>realidad</strong> que queremos estudiar. <br />
Buscando <strong>patrones</strong> construimos <strong>modelos</strong> que simplifiquen esta realidad y nos ayuden a sacar ventajas.<br />
Los modelos buscan el equilibrio entre representar bien la realidad y la simplicidad de uso.<br /></p>
<p>Elementos:</p>
<ul>
<li>datos: valores sacados de la realidad que alimentan el modelo</li>
<li>parámetros: valores que se pueden variar para ajustar el modelo</li>
<li>error: mide el grado de ajuste de nuestro modelo a los datos</li>
</ul>
<p>Partiendo de un modelo inicial, el objetivo será <strong>optimizar</strong>lo (entrenarlo, ajustarlo) a través de la variación de los parámetros buscando el mínimo error.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="El-modelo:-Regresi&#243;n-lineal-como-primer-acercamiento">El modelo: Regresi&#243;n lineal como primer acercamiento<a class="anchor-link" href="#El-modelo:-Regresi&#243;n-lineal-como-primer-acercamiento"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Dentro del <em>aprendizaje automático</em> (machine learning) hay tres ramas diferenciadas:</p>
<ul>
<li><strong>aprendizaje supervisado</strong>: se tiene datos etiquetados (clasificados), sabemos el objetivo buscado</li>
<li><strong>aprendizaje no supervisado</strong>: se busca sacar conocimiento con datos no etiquetados, se desconoce a priori el objetivo. </li>
<li><strong>aprendizaje reforzado</strong>: se establece un sistema de refuerzos y penalizaciones para llegar al objetivo</li>
</ul>
<p>Nosotros comenzaremos por el aprendizaje supervisado escogiendo lo más sencillo, un modelo lineal.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Regresi&#243;n-lineal-simple:-una-variable">Regresi&#243;n lineal simple: una variable<a class="anchor-link" href="#Regresi&#243;n-lineal-simple:-una-variable"> </a></h4><p>Tenemos sólo una variable <strong>x</strong> de entrada (v. independiente), y se busca un resultado <strong>y</strong> que depende de la anterior. Existe una relación lineal entre ambas, por lo que se representa como una línea:</p>
<p>y = b + w1 * x</p>
<p>b y w1 son los parámetros: el sesgo y la pendiente de la línea</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/blog/images/copied_from_nb/images/linea.png" alt="" title="y = b + w1 * x" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Regresi&#243;n-lineal-m&#250;ltiple">Regresi&#243;n lineal m&#250;ltiple<a class="anchor-link" href="#Regresi&#243;n-lineal-m&#250;ltiple"> </a></h4><h5 id="2-variables">2 variables<a class="anchor-link" href="#2-variables"> </a></h5><p>Representan un plano</p>
<p>y = b + w1 <em> x1 + w2 </em> x2</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/blog/images/copied_from_nb/images/plano.png" alt="" title="y = b + w1 * x1 + w2 * x2" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="n-variables">n variables<a class="anchor-link" href="#n-variables"> </a></h5><p>Representan un hiperplano</p>
<p>y = b + w1 <em> x1 + w2 </em> x2 + w3 <em> x3 + ... + wn</em> xn</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><hr />
Tanto para regresion lineal simple como múltiple tendremos unos datos sacados de la realidad y queremos encontrar un modelo (una línea, plano,...) que se aproxime a ellos:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/blog/images/copied_from_nb/images/estimacion01.png" alt="" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Para cada punto podemos calcular el error (distancia) que hay entre el valor real y la predicción:<br />
<br />
error = Y real - Y estimado
<br /><br />
El <strong>error</strong> (coste) <strong>del modelo</strong> será la media de estas distancias:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">error_media_abs</span> <span class="o">=</span> <span class="p">((</span><span class="n">y_real</span><span class="o">-</span><span class="n">y_estimado</span><span class="p">))</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/blog/images/copied_from_nb/images/estimacion02.png" alt="" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Aunque, se suele utilizar la raiz cuadrada del <strong>error medio cuadrático (MSE)</strong> porque penaliza más cuanto mayor sea el error:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">error_mse</span> <span class="o">=</span> <span class="p">((</span><span class="n">y_real</span><span class="o">-</span><span class="n">y_estimado</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">F</span><span class="o">.</span><span class="n">l1_loss</span><span class="p">(</span><span class="n">y_real</span><span class="o">.</span><span class="n">float</span><span class="p">(),</span><span class="n">y_estimado</span><span class="p">)</span>
<span class="n">F</span><span class="o">.</span><span class="n">mse_loss</span><span class="p">(</span><span class="n">y_real</span><span class="p">,</span><span class="n">y_estimado</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="El-aprendizaje:-Descenso-del-gradiente">El aprendizaje: Descenso del gradiente<a class="anchor-link" href="#El-aprendizaje:-Descenso-del-gradiente"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Una vez tenemos el modelo y la función de error, iremos dando valores a los parámetros <strong>w y b</strong> buscando el menor error hasta encontrar el modelo que mejor se ajuste a la realidad.</p>
<p>Queremos que ese ajuste de parámetros se realice de forma autónoma. Para ello tenemos la herramienta <strong>desceso del gradiente</strong>.</p>
<p>La técnica de <em>descenso del gradiente</em> consiste en moverse por la función de error buscando el punto donde se minimiza. Para ello, en cada posición, busca la dirección en la que se reduce más el error. Esto se obtiene con la derivada parcial en el punto respecto de cáda parámetro (el gradiente de la función), que es la pendiente de la curva.</p>
<p>Una vez obtenida la dirección en que hay que moverse se recalculan los parámetros de la siguiente forma:</p>
<p>w := w - gradiente(w) * lr</p>
<p>'lr' es la <strong>tasa de aprendizaje</strong>, que define el tamaño del paso que se realizará. Si es demasiado pequeño se necesitará mucho tiempo para alcanzar el mínimo y si es muy grande seguramente se pasará de largo sin llegar al mínimo.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">funcion_error</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">parametros</span><span class="o">.</span><span class="n">grad</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><hr />
Ahora ya podemos preparar el algoritmo de aprendizaje automático. Los pasos serán:</p>

<pre><code>1- Cargar los datos y escoger el modelo
2- Inicializar los parámetros: se suele hacer de forma aleatoria</code></pre>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">parametros</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">num_parametros</span><span class="p">)</span><span class="o">.</span><span class="n">requires_grad_</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>3- Calcular la predicciones
4- Calcular el error (coste)  </code></pre>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">error</span> <span class="o">=</span> <span class="n">mse</span><span class="p">(</span><span class="n">prediciones</span><span class="p">,</span> <span class="n">valores_reales</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>5- Calcular el gradiente
6- Realizar el paso, modificación de los parámetros</code></pre>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lr</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="n">parametros</span><span class="o">.</span><span class="n">data</span> <span class="o">-=</span> <span class="n">lr</span> <span class="o">*</span> <span class="n">parametros</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span>
<span class="n">parametros</span><span class="o">.</span><span class="n">grad</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>7- Repetir el proceso (punto 3) las veces necesarias</code></pre>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="juandrh/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/blog/curso_fast.ai/ml/2021/07/28/Aprendizaje-automatico.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Aprendiendo Inteligencia Artificial a los 50.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/juandrh" title="juandrh"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/juandrh2_0" title="juandrh2_0"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
